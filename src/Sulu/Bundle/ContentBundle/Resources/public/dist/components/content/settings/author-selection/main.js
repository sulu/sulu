define(["jquery","text!/admin/api/contacts/fields"],function(a,b){"use strict";var c={options:{data:{authored:null,author:null},selectCallback:function(a){},matchings:JSON.parse(b)},translations:{authored:"sulu.content.form.settings.authored"},templates:{skeleton:['<div class="grid">','   <div class="grid-row form-group">','       <label for="authored"><%= translations.authored %></label>','       <div class="authored-component"','            data-aura-component="input@husky"','            data-aura-skin="date"','            data-value="<%= authored %>" />',"       </div>","   </div>",'   <div class="grid-row search-row">','       <div class="grid-col-8"/>','       <div class="grid-col-4 author-selection-search"/>',"   </div>",'   <div class="grid-row">','       <div class="grid-col-12 author-selection-list" style="max-height: 500px; overflow: scroll;"/>',"   </div>","</div>"].join("")}};return{defaults:c,initialize:function(){this.data=this.options.data,this.bindCustomEvents(),this.html(a(this.templates.skeleton({translations:this.translations,authored:this.options.data.authored?this.options.data.authored:null}))),this.sandbox.start([{name:"search@husky",options:{el:".author-selection-search",appearance:"white small",instanceName:"author-selection-search"}},{name:"datagrid@husky",options:{el:".author-selection-list",instanceName:"author-selection",url:"/admin/api/contacts?flat=true",resultKey:"contacts",sortable:!1,selectedCounter:!1,searchInstanceName:"author-selection-search",searchFields:["fullName","mainEmail"],preselected:this.options.data.author?[this.options.data.author]:[],paginationOptions:{dropdown:{limit:20}},viewOptions:{table:{selectItem:{type:"radio"}}},matchings:this.options.matchings}}])},bindCustomEvents:function(){this.sandbox.once("sulu.content.contents.get-author",function(){this.data.authored=this.$el.find(".authored-component").data("value"),this.sandbox.emit("husky.datagrid.author-selection.items.get-selected",function(a,b){b.length>0&&(this.data.author=a[0],this.data.authorItem=b[0]),this.options.selectCallback(this.data)}.bind(this),!0)}.bind(this))}}});