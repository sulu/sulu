define(["services/sulucontact/contact-manager","services/sulucontact/contact-router"],function(a,b){"use strict";var c={datagridInstanceName:"contacts",listViewStorageKey:"contactListView",listPaginationStorageKey:"contactListPagination"},d=function(){this.sandbox.on("sulu.toolbar.delete",function(){this.sandbox.emit("husky.datagrid."+c.datagridInstanceName+".items.get-selected",e.bind(this))},this),this.sandbox.on("sulu.contacts.contact.deleted",function(a){this.sandbox.emit("husky.datagrid."+c.datagridInstanceName+".record.remove",a)},this),this.sandbox.on("sulu.toolbar.add",function(){b.toAdd()},this),this.sandbox.on("husky.datagrid."+c.datagridInstanceName+".number.selections",function(a){var b=a>0?"enable":"disable";this.sandbox.emit("sulu.header.toolbar.item."+b,"deleteSelected",!1)},this),this.sandbox.on("sulu.toolbar.change.table",function(){this.sandbox.sulu.saveUserSetting(c.listViewStorageKey,"table"),this.sandbox.sulu.saveUserSetting(c.listPaginationStorageKey,"dropdown"),this.sandbox.emit("husky.datagrid."+c.datagridInstanceName+".view.change","table"),this.sandbox.emit("husky.datagrid."+c.datagridInstanceName+".pagination.change","dropdown"),this.sandbox.emit("husky.datagrid."+c.datagridInstanceName+".change.page",1),this.sandbox.stickyToolbar.reset(this.$el)}.bind(this)),this.sandbox.on("sulu.toolbar.change.cards",function(){this.sandbox.sulu.saveUserSetting(c.listViewStorageKey,"datagrid/decorators/card-view"),this.sandbox.sulu.saveUserSetting(c.listPaginationStorageKey,"infinite-scroll"),this.sandbox.emit("husky.datagrid."+c.datagridInstanceName+".view.change","datagrid/decorators/card-view"),this.sandbox.emit("husky.datagrid."+c.datagridInstanceName+".pagination.change","infinite-scroll"),this.sandbox.emit("husky.datagrid."+c.datagridInstanceName+".change.page",1),this.sandbox.stickyToolbar.reset(this.$el)}.bind(this))},e=function(b){this.sandbox.sulu.showDeleteDialog(function(c){c&&a["delete"](b)}.bind(this))},f=function(a){b.toEdit(a)};return{stickyToolbar:!0,layout:{content:{width:"max"}},header:{noBack:!0,title:"contact.contacts.title",underline:!1,toolbar:{buttons:{add:{},deleteSelected:{},"export":{options:{urlParameter:{flat:!0},url:"/admin/api/contacts.csv"}}}}},templates:["/admin/contact/template/contact/list"],initialize:function(){this.render(),d.call(this)},getListToolbarConfig:function(){return{el:this.$find("#list-toolbar-container"),instanceName:"contacts",template:this.sandbox.sulu.buttons.get({contactDecoratorDropdown:{},settings:{options:{dropdownItems:[{type:"columnOptions"}]}}})}},getDatagridConfig:function(){return{el:this.sandbox.dom.find("#people-list",this.$el),url:"/admin/api/contacts?flat=true",searchInstanceName:"contacts",searchFields:["fullName","mainEmail"],resultKey:"contacts",instanceName:c.datagridInstanceName,actionCallback:f.bind(this),view:this.sandbox.sulu.getUserSetting(c.listViewStorageKey)||"datagrid/decorators/card-view",pagination:"infinite-scroll",viewOptions:{table:{actionIconColumn:"firstName",noImgIcon:"fa-user"},"datagrid/decorators/card-view":{fields:{picture:"avatar",title:["firstName","lastName"]},icons:{picture:"fa-user"}}},paginationOptions:{"infinite-scroll":{reachedBottomMessage:"public.reached-list-end"}}}},render:function(){this.sandbox.dom.html(this.$el,this.renderTemplate("/admin/contact/template/contact/list")),this.sandbox.sulu.initListToolbarAndList.call(this,"contacts","/admin/api/contacts/fields",this.getListToolbarConfig(),this.getDatagridConfig(),"contacts","#people-list-info")}}});