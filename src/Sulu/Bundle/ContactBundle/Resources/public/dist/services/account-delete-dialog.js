define(["services/sulucontact/account-manager","services/husky/util","services/husky/mediator","services/husky/translator"],function(a,b,c,d){"use strict";var e={dialogEntityFoundTemplate:["<p><%= foundMessage %>:</p>",'<% if (typeof list !== "undefined") { %>',"<ul><%= list %></ul>","<% } %>",'<% if (typeof numChildren !== "undefined" && numChildren > 3 && typeof andMore !== "undefined") { %>',"<p><%= andMore %></p>","<% } %>","<p><%= description %></p>",'<% if (typeof checkboxText !== "undefined") { %>',"<p>",'   <label for="overlay-checkbox">','       <div class="custom-checkbox">','           <input type="checkbox" id="overlay-checkbox" class="form-element" />','           <span class="icon"></span>',"       </div>","       <%= checkboxText %>","</label>","</p>","<% } %>"].join("")},f={dependencyListContacts:function(a){var c="<% _.each(contacts, function(contact) { %> <li><%= contact.firstName %> <%= contact.lastName %></li> <% }); %>";return b.template(c,{contacts:a})},dependencyListAccounts:function(a){var c="<% _.each(accounts, function(account) { %> <li><%= account.name %></li> <% }); %>";return b.template(c,{accounts:a})}},g=function(a,g){var h,i,j="contact.accounts.delete.desc",k="show-warning",l=b.capitalizeFirstLetter(d.translate("public.delete"))+"?",m=function(){var a=!(!$("#overlay-checkbox").length||!$("#overlay-checkbox").prop("checked"));g(a)};parseInt(a.numChildren,10)>0?(h=a.numChildren-a.children.length,k="show-error",l="sulu.overlay.error",m=void 0,j=b.template(e.dialogEntityFoundTemplate,{foundMessage:d.translate("contact.accounts.delete.sub-found"),list:f.dependencyListAccounts(a.children),numChildren:parseInt(a.numChildren,10),andMore:b.template(d.translate("public.and-number-more"),{number:h}),description:d.translate("contact.accounts.delete.sub-found-desc")})):parseInt(a.numContacts,10)>0&&(i=a.numContacts-a.contacts.length,j=b.template(e.dialogEntityFoundTemplate,{foundMessage:d.translate("contact.accounts.delete.contacts-found"),list:f.dependencyListContacts(a.contacts),numChildren:parseInt(a.numContacts,10),andMore:b.template(d.translate("public.and-number-more"),{number:i}),description:d.translate("contact.accounts.delete.contacts-question"),checkboxText:b.template(d.translate("contact.accounts.delete.contacts-checkbox"),{number:parseInt(a.numContacts,10)})})),c.emit("sulu.overlay."+k,l,j,null,m,{okDefaultText:"public.delete"})},h=function(a,f){var g="contact.accounts.delete.desc",h="sulu.overlay.be-careful",i="show-warning",j=function(){var a=!(!$("#overlay-checkbox").length||!$("#overlay-checkbox").prop("checked"));f(a)};parseInt(a.numChildren,10)>0?(i="show-error",h="sulu.overlay.error",j=void 0,g=b.template(e.dialogEntityFoundTemplate,{foundMessage:d.translate("contact.accounts.delete.sub-found"),description:d.translate("contact.accounts.delete.sub-found-desc")})):parseInt(a.numContacts,10)>0&&(g=b.template(e.dialogEntityFoundTemplate,{foundMessage:d.translate("contact.accounts.delete.contacts-found"),numChildren:parseInt(a.numContacts,10),description:d.translate("contact.accounts.delete.contacts-question"),checkboxText:b.template(d.translate("contact.accounts.delete.contacts-checkbox"),{number:parseInt(a.numContacts,10)})})),c.emit("sulu.overlay."+i,h,g,null,j,{okDefaultText:"public.ok"})};return{showDialog:function(b,c){$.isArray(b)||(b=[b]),0!==b.length&&(1===b.length?a.loadDeleteInfo(b[0]).then(function(a){g(a,c)}):a.loadMultipleDeleteInfo(b).then(function(a){h(a,c)}))}}});