define(["jquery","underscore","text!./condition-list.html"],function(a,b,c){var d={addButtonSelector:".addButton",removeButtonSelector:".remove",conditionRowSelector:".condition-row",typeSelectSelector:"[data-condition-type]",conditionSelector:"[data-condition]",conditionIdSelector:"[data-condition-id]"},e=function(){this.$el.on("click",d.addButtonSelector,function(){f.call(this)}.bind(this)),this.$el.on("click",d.removeButtonSelector,function(b){a(b.currentTarget).parents(d.conditionRowSelector).remove()}),this.$el.on("change",d.typeSelectSelector,function(b){var c=a(b.currentTarget);g.call(this,c.parents(d.conditionRowSelector),c.data("selection")[0])}.bind(this))},f=function(b){var c=a(this.options.conditionRowTemplate({translations:this.translations}));this.$conditionList.append(c),this.sandbox.start(c).then(function(){b&&(c.find(d.conditionIdSelector).val(b.id),c.find(d.typeSelectSelector).data({selection:[b.type],selectionValues:[c.find("[data-id="+b.type+"] .item-value").html()]}).trigger("data-changed"),g.call(this,c,b.type),Object.keys(b.condition).forEach(function(a){var d=b.condition[a],e=h(c,a),f=e.data("rule-type");if("internal_link"===f)e.data("singleInternalLink",d);else if("select"===f){var g=null;e.data("auraData").forEach(function(a,b){return a.name===d?(g=b,!1):void 0}),e.data({selection:[d]})}else e.val(d)}))}.bind(this))},g=function(a,c){var e=a.find(d.conditionSelector);i.call(this,e),e.html(b.template(this.options.conditionTypesTemplate.find("#"+c).html(),{locale:this.sandbox.sulu.getDefaultContentLocale()})),this.sandbox.start(e)},h=function(a,b){return a.find("[data-condition-name="+b+"]")},i=function(a){this.sandbox.stop(a.find("[data-aura-component]"))};return{defaults:{templates:{conditionList:c},translations:{conditionAdd:"sulu_audience_targeting.condition-add",pleaseChoose:"public.please-choose"}},initialize:function(){this.render(),e.call(this)},render:function(){this.$el.html(this.templates.conditionList({translations:this.translations})),this.$conditionList=this.$el.find(".condition-list"),this.options.data&&this.options.data.forEach(function(a){f.call(this,a)}.bind(this))}}});